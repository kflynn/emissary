{
    "name": "Emissary Development",
    "build": {
        "dockerfile": "Dockerfile",
        "context": ".."
    },
    // Features to add to the dev container
    "features": {},
    // Configure tool-specific properties
    "customizations": {
        "vscode": {
            "settings": {
                "go.toolsManagement.checkForUpdates": "local",
                "go.useLanguageServer": true,
                "go.gopath": "/home/dev/go",
                "go.goroot": "/usr/local/go",
                "python.defaultInterpreterPath": "/home/dev/.local/share/uv/python",
                "files.watcherExclude": {
                    "**/vendor/**": true,
                    "**/.git/**": true,
                    "**/node_modules/**": true
                }
            },
            "extensions": [
                "golang.go",
                "ms-python.python",
                "ms-kubernetes-tools.vscode-kubernetes-tools",
                "ms-vscode.vscode-yaml",
                "redhat.vscode-yaml",
                "tim-koehler.helm-intellisense",
                "GitHub.copilot",
                "GitHub.copilot-chat"
            ]
        }
    },
    // Mounts and environment
    "mounts": [
        // Mount Docker socket for k3d and other Docker operations
        "source=/var/run/docker.sock,target=/var/run/docker.sock,type=bind"
    ],
    "remoteEnv": {
        "GOPATH": "/home/dev/go",
        "GOBIN": "/home/dev/go/bin",
        "PATH": "/home/dev/.cargo/bin:/home/dev/go/bin:${containerEnv:PATH}"
    },
    // Forward common development ports
    "forwardPorts": [
        8080, // Common HTTP port
        8443, // Common HTTPS port
        6443, // Kubernetes API server
        9901, // Envoy admin
        8877 // Emissary debug port
    ],
    // Use 'postCreateCommand' to run commands after the container is created
    "postCreateCommand": "echo 'Dev container ready! Run make help to see available commands.'",
    // Keep container running
    "shutdownAction": "none",
    // Run as the dev user
    "remoteUser": "dev",
    // Container will need privileged access for Docker operations
    "privileged": true,
    // Additional run arguments
    "runArgs": [
        "--privileged"
    ]
}